<!doctype html>
<html class="no-js" lang="en">


<!-- Mirrored from template.hasthemes.com/toro/toro/checkout.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 09 Feb 2024 11:20:00 GMT -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>PFUME</title>
    <meta name="robots" content="noindex, follow" />
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="assets/images/favicon.png">

    <!-- All CSS is here
	============================================ -->

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="assets/css/vendor/bootstrap.min.css">
    <!-- Icon Font CSS -->
    <link rel="stylesheet" href="assets/css/vendor/font-awesome.css">
    <link rel="stylesheet" href="assets/css/vendor/dlicon.css">
    <!-- Others CSS -->
    <link rel="stylesheet" href="assets/css/plugins/owl-carousel.css">
    <link rel="stylesheet" href="assets/css/plugins/slick.css">
    <link rel="stylesheet" href="assets/css/plugins/magnific-popup.css">
    <link rel="stylesheet" href="assets/css/plugins/jarallax.css">
    <link rel="stylesheet" href="assets/css/plugins/easyzoom.css">
    <link rel="stylesheet" href="assets/css/plugins/animate.css">
    <link rel="stylesheet" href="assets/css/plugins/fullpage.css">
    <link rel="stylesheet" href="assets/css/plugins/jquery-ui.css">
    <link rel="stylesheet" href="assets/css/plugins/select2.min.css">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.css">

    <style>
        
    #coupon-message {
        color: green; /* Default success message color */
    }

    #coupon-message.error {
        color: red; /* Error message color */
    }

    </style>

</head>

<body>

    <div class="main-wrapper">
        <header class="header-area section-padding-1">
            <div class="container-fluid">
                <div class="row align-items-center">
                    <div class="col-xl-2 col-lg-2">
                        <div class="logo logo-width">
                            <a href="index.html">
                                <img src="assets/images/logo/logo.png" alt="logo">
                            </a>
                        </div>
                    </div>
                    <div class="col-xl-8 col-lg-8 d-flex justify-content-center position-static">
                        <div class="main-menu menu-lh-1 main-menu-padding-1">
                            <nav>
                                <ul>
                                    <li class="position-static"><a href="/user/home">Home </a>
                                    </li>
                                    <li><a href="/user/shop">Shop </a>
                                    </li>
                                    <!-- <li><a href="shop-collection-1.html">Collections <i class="fa fa-angle-down"></i> </a>
                                        <ul class="sub-menu-width">
                                            <li><a href="shop-collection-1.html">Shop Collection 01</a></li>
                                            <li><a href="shop-collection-2.html">Shop Collection 02</a></li>
                                            <li><a href="shop-metro.html">Shop Metro Layout</a></li>
                                        </ul>
                                    </li>
                                    <li><a href="blog.html">Blog <i class="fa fa-angle-down"></i></a>
                                        <ul class="sub-menu-width">
                                            <li><a href="blog.html">Blog Style 01</a></li>
                                            <li><a href="blog-2.html">Blog Style 02</a></li>
                                            <li><a href="blog-3.html">Blog Style 03</a></li>
                                            <li><a href="#">Single Posts <i class="fa fa-angle-right"></i></a>
                                                <ul class="lavel-menu">
                                                    <li><a href="blog-details.html">Single Post Style 01</a></li>
                                                    <li><a href="blog-details-2.html">Single Post Style 02</a></li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><a href="shop-instagram.html">Instagram Shop </a></li> -->
                                </ul>
                            </nav>
                        </div>
                    </div>
                    <div class="col-xl-2 col-lg-2">
                        <div class="header-right-wrap header-right-flex">
                            <div class="same-style header-wishlist">
                                <a href="/user/wishlist"><i class="fa fa-heart-o"></i></a>
                            </div>
                            <div class="same-style cart-wrap">
                                <a href="/user/cart">
                                    <i class="dlicon shopping_bag-20"></i>
                                    <span class="count-style"><%= cartItemNo%></span>
                                </a>
                            </div>
                            <div class="same-style header-search">
                                <a class="search-active" href="#">
                                    <i class="dlicon ui-1_zoom"></i>
                                </a>
                            </div>
                            <div class="same-style header-off-canvas">
                                <a class="header-aside-button" href="#">
                                    <i class="dlicon ui-3_menu-left"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <div class="header-small-mobile section-padding-1">
            <div class="container-fluid">
                <div class="row align-items-center">
                    <div class="col-6">
                        <div class="mobile-logo logo-width">
                            <a href="index.html">
                                <img alt="" src="assets/images/logo/logo.png">
                            </a>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="mobile-header-right-wrap">
                            <div class="header-right-wrap header-right-flex">
                                <div class="same-style cart-wrap">
                                    <a href="#" class="cart-active">
                                        <i class="dlicon shopping_bag-20"></i>
                                        <span class="count-style">02</span>
                                    </a>
                                </div>
                                <div class="same-style header-off-canvas">
                                    <a class="header-aside-button" href="#">
                                        <i class="dlicon ui-3_menu-left"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- search start -->
        <div class="search-content-wrap main-search-active">
            <a class="search-close"><i class="dlicon ui-1_simple-remove"></i></a>
            <div class="search-content">
                <p>Start typing and press Enter to search</p>
                <form class="search-form" action="#">
                    <input type="text" placeholder="Search">
                    <button class="button-search"><i class="dlicon ui-1_zoom"></i></button>
                </form>
            </div>
        </div>
        <!-- mini cart start -->
        <div class="sidebar-cart-active">
            <div class="sidebar-cart-all">
                <a class="cart-close" href="#"><i class="dlicon ui-1_simple-remove"></i></a>
                <div class="cart-content">
                    <h3>Shopping Cart</h3>
                    <ul>
                        <li class="single-product-cart">
                            <div class="cart-img">
                                <a href="#"><img src="assets/images/cart/cart-1.jpg" alt=""></a>
                            </div>
                            <div class="cart-title">
                                <h4><a href="#">Bejewelled velvet sandals</a></h4>
                                <span> 1 × $49.00	</span>
                            </div>
                            <div class="cart-delete">
                                <a href="#">×</a>
                            </div>
                        </li>
                        <li class="single-product-cart">
                            <div class="cart-img">
                                <a href="#"><img src="assets/images/cart/cart-2.jpg" alt=""></a>
                            </div>
                            <div class="cart-title">
                                <h4><a href="#">Contrast faux fur jacket</a></h4>
                                <span> 1 × $49.00	</span>
                            </div>
                            <div class="cart-delete">
                                <a href="#">×</a>
                            </div>
                        </li>
                    </ul>
                    <div class="cart-total">
                        <h4>Subtotal: <span>$170.00</span></h4>
                    </div>
                    <div class="cart-checkout-btn">
                        <a class="btn-hover cart-btn-style" href="cart.html">view cart</a>
                        <a class="no-mrg btn-hover cart-btn-style" href="checkout.html">checkout</a>
                    </div>
                </div>
            </div>
        </div>
        <!-- aside start -->
        <div class="header-aside-active">
            <div class="header-aside-wrap">
                <a class="aside-close"><i class="dlicon ui-1_simple-remove"></i></a>
                <div class="header-aside-content">
                    <div class="mobile-menu-area">
                        <div class="mobile-search">
                            <form class="search-form" action="#">
                                <input type="text" placeholder="Search entire store…">
                                <button class="button-search"><i class="dlicon ui-1_zoom"></i></button>
                            </form>
                        </div>
                        <div class="mobile-menu-wrap">
                            <!-- mobile menu start -->
                            <div class="mobile-navigation">
                                <!-- mobile menu navigation start -->
                                <nav>
                                    <ul class="mobile-menu">
                                        <li class="menu-item-has-children"><a href="index.html">Home</a>
                                            
                                        </li>
                                        <li class="menu-item-has-children"><a href="#">Pages</a>
                                            <ul class="dropdown">
                                                <li><a href="about-us.html">About Us</a></li>
                                                <li><a href="contact-us.html">Contact Page</a></li>
                                                <li><a href="404.html">404 Page</a></li>
                                                <li><a href="comming-soon.html">Comming Soon 01</a></li>
                                                <li><a href="comming-soon-2.html">Comming Soon 02</a></li>
                                                <li><a href="faq.html">FAQ</a></li>
                                            </ul>
                                        </li>
                                        <li class="menu-item-has-children "><a href="shop-fullwide.html">shop</a>
                                            <ul class="dropdown">
                                                <li class="menu-item-has-children"><a href="#">Shop Layout</a>
                                                    <ul class="dropdown">
                                                        <li><a href="shop-fullwide.html">Shop Fullwidth</a></li>
                                                        <li><a href="shop-sidebar.html">Shop Sidebar</a></li>
                                                        <li><a href="shop-metro.html">Shop Metro Layout</a></li>
                                                        <li><a href="shop-3-col.html">Shop 03 Columns</a></li>
                                                        <li><a href="shop-2-col.html">Shop 02 Columns</a></li>
                                                        <li><a href="shop-collection-1.html">Shop Collection 01</a></li>
                                                        <li><a href="shop-collection-2.html">Shop Collection 02</a></li>
                                                    </ul>
                                                </li>
                                                <li class="menu-item-has-children"><a href="#">Product Layout</a>
                                                    <ul class="dropdown">
                                                        <li><a href="product-details.html">Single 01</a></li>
                                                        <li><a href="product-details-2.html">Single 02</a></li>
                                                        <li><a href="product-details-group.html">Grouped</a></li>
                                                        <li><a href="product-details-sticky.html">Sticky Info</a></li>
                                                        <li><a href="product-details-configurable.html">Configurable</a></li>
                                                        <li><a href="product-details-thumbnail.html">Thumbnail</a></li>
                                                        <li><a href="product-details-video.html">Video</a></li>
                                                        <li><a href="product-details-affiliate.html">Affiliate</a></li>
                                                        <li><a href="product-details-sidebar.html">Sidebar</a></li>
                                                    </ul>
                                                </li>
                                                <li class="menu-item-has-children"><a href="#">Shop Pages </a>
                                                    <ul class="dropdown">
                                                        <li><a href="my-account.html">My Account</a></li>
                                                        <li><a href="checkout.html">Check Out</a></li>
                                                        <li><a href="cart.html">Shopping Cart</a></li>
                                                        <li><a href="wishlist.html">Wishlist</a></li>
                                                        <li><a href="order-tracking.html">Order Tracking</a></li>
                                                        <li><a href="compare.html">Compare</a></li>
                                                        <li><a href="login-register.html">login / register</a></li>
                                                    </ul>
                                                </li>
                                            </ul>
                                        </li>
                                        <li class="menu-item-has-children "><a href="shop-collection-1.html">Collection</a>
                                            <ul class="dropdown">
                                                <li><a href="shop-collection-1.html">Shop Collection 01</a></li>
                                                <li><a href="shop-collection-2.html">Shop Collection 02</a></li>
                                                <li><a href="shop-metro.html">Shop Metro Layout</a></li>
                                            </ul>
                                        </li>
                                        <li class="menu-item-has-children "><a href="blog.html">Blog</a>
                                            <ul class="dropdown">
                                                <li><a href="blog.html">Blog Style 01</a></li>
                                                <li><a href="blog-2.html">Blog Style 02</a></li>
                                                <li><a href="blog-3.html">Blog Style 03</a></li>
                                                <li><a href="blog-details.html">Single Post Style 01</a></li>
                                                <li><a href="blog-details-2.html">Single Post Style 02</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="shop-instagram.html">Instagram Shop </a></li>
                                    </ul>
                                </nav>
                                <!-- mobile menu navigation end -->
                            </div>
                            <!-- mobile menu end -->
                        </div>
                        <div class="mobile-curr-lang-wrap">
                            <div class="single-mobile-curr-lang">
                                <a class="mobile-language-active" href="#">Language <i class="fa fa-angle-down"></i></a>
                                <div class="lang-curr-dropdown lang-dropdown-active">
                                    <ul>
                                        <li><a href="#">English (US)</a></li>
                                        <li><a href="#">English (UK)</a></li>
                                        <li><a href="#">Spanish</a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="single-mobile-curr-lang">
                                <a class="mobile-currency-active" href="#">Currency <i class="fa fa-angle-down"></i></a>
                                <div class="lang-curr-dropdown curr-dropdown-active">
                                    <ul>
                                        <li><a href="#">USD</a></li>
                                        <li><a href="#">EUR</a></li>
                                        <li><a href="#">Real</a></li>
                                        <li><a href="#">BDT</a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="single-mobile-curr-lang">
                                <a class="mobile-account-active" href="#">My Account <i class="fa fa-angle-down"></i></a>
                                <div class="lang-curr-dropdown account-dropdown-active">
                                    <ul>
                                        <li><a href="#">Login</a></li>
                                        <li><a href="#">Creat Account</a></li>
                                        <li><a href="my-account.html">My Account</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="header-aside-menu">
                        <nav>
                            <ul>
                                <li><a href="/user/myaccount">My Account</a></li>
                                <li><a href="/user/shop">Shop</a></li>
                                <!-- <li><a href="#">Collection</a></li>
                                <li><a href="#">Blog</a></li>
                                <li><a href="#">New Look</a></li> -->
                                <li><a href="/user/logout">Log Out</a></li>
                            </ul>
                        </nav>
                    </div>
                    <img src="assets/images/icon-img/payments.png" alt="payment">
                    <p>Pellentesque mollis nec orci id tincidunt. Sed mollis risus eu nisi aliquet, sit amet fermentum justo dapibus.</p>
                    <div class="aside-contact-info">
                        <ul>
                            <li><i class="dlicon ui-2_time-clock"></i>Monday - Friday: 9:00 - 19:00</li>
                            <li><i class="dlicon ui-1_email-84"></i>Info@la-studioweb.com</li>
                            <li><i class="dlicon tech-2_rotate"></i>(+55) 254. 254. 254</li>
                            <li><i class="dlicon ui-1_home-minimal"></i>Helios Tower 75 Tam Trinh Hoang - Ha Noi - Viet Nam</li>
                        </ul>
                    </div>
                    <div class="social-icon-style mb-25">
                        <a class="facebook" href="#"><i class="fa fa-facebook"></i></a>
                        <a class="twitter" href="#"><i class="fa fa-twitter"></i></a>
                        <a class="google-plus" href="#"><i class="fa fa-google-plus"></i></a>
                        <a class="behance" href="#"><i class="fa fa-behance"></i></a>
                    </div>
                    <div class="copyright">
                        <p>© 2021 <a href="https://hasthemes.com/">Toro.</a> All rights reserved</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="breadcrumb-area section-padding-1 bg-gray breadcrumb-ptb-1">
            <div class="container-fluid">
                <div class="breadcrumb-content text-center">
                    <div class="breadcrumb-title">
                        <h2>Checkout</h2>
                    </div>
                    <ul>
                        <li>
                            <a href="/user/home">Home </a>
                        </li>
                        <li><span> &gt; </span></li>
                        <li class="active">Checkout </li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- checkout start -->
        <div class="checkout-main-area pt-100 pb-100">
            <div class="container">
                <div class="customer-zone mb-30">
                    <p class="cart-page-title">Have a coupon? <a class="checkout-click" href="#">Click here to enter your code</a></p>
                    <div class="checkout-login-info">
                        <p>If you have a coupon code, please apply it below.</p>
                        <form id="coupon-form" onsubmit="applyCoupon(event)">
                            <input type="text" id="coupon-code" name="couponCode" placeholder="Coupon code" required>
                            <input type="submit" value="Apply Coupon">
                        </form>
                        <button class="btn border" id="remove-coupon" onclick="removeCoupon()" style="display:none;">Remove Coupon</button> 
                        <p id="coupon-message"></p>
                        <div id="available-coupons">
                            <p>Available Coupons:</p>
                            <ul id="coupon-list"></ul>
                        </div>
                    </div>
                </div>
                
                
                <div class="checkout-wrap">
                    <div class="row">
                        <div class="col-lg-7">
                            <div id="addressContainer" data-address='<%= JSON.stringify(address) %>'  class="billing-info-wrap mr-100">
                                <h3>Billing Details</h3>
                                <div class="tab-pane show active">
                                    <div class="card-header">
                                        <h3 class="mb-0">Address</h3>
                                    </div><br>
                                    <% address.forEach(row => { %>
                                        <% row.addressDetails.forEach(details => { %>
                                            <div class="row">
                                                <div class="card-header">
                                                    <h5 class="mb-0">
                                                        <input type="radio" style="width: 15px;" name="addressID" id="addressID" value="<%= details._id %>"> 
                                                        
                                                    </h5>
                                                </div>
                                                <div class="card-body">
                                                    <address>
                                                        <%= details.name %>,<br>
                                                        <%= details.address %>,<br>
                                                        <%= details.country %>,<br>
                                                        <%= details.state %>,<br>
                                                        <%= details.city %>,<br>
                                                        <%= details.pincode %>
                                                    </address>
                                                    <button type="button" class="btn btn-secondary" onclick="openEditAddressModal('<%= details._id %>')">
                                                        Edit Address
                                                    </button>
                                                </div>
                                            </div>
                                            <hr>
                                        <% }); %>
                                    <% }); %>
                                    
                                                    <br>
                                                    <div class="add-new-address">
                                                        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addAddressModal">
                                                            + Add New Address
                                                        </button>
                                                    </div>
                                </div>
                                <br>
                                <div class="additional-info-wrap">
                                    <h3>Additional information</h3>
                                    <label>Order notes (optional)</label>
                                    <textarea placeholder="Notes about your order, e.g. special notes for delivery. " name="message"></textarea>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-5">
                            <div class="your-order-area">
                                <h3>Your order</h3>
                                <div class="your-order-wrap gray-bg-4">
                                    <div class="your-order-info-wrap">
                                        <div class="your-order-info">
                                            <ul>
                                                <li>Product <span>Total</span></li>
                                            </ul>
                                        </div>
                                        <div class="your-order-middle">
                                            <% for(let i=0;i<cartItems.length;i++){ %>
                                            <ul>
                                                <li><%= cartItems[i].product.title %> X <%= cartItems[i].quantity %> <span>₹<%= cartItems[i].product.price * cartItems[i].quantity %> </span></li>
                                                
                                            </ul>
                                            <% } %>
                                        </div>
                                        <div class="your-order-info order-subtotal">
                                            <ul>
                                                <li>Subtotal <span>₹<%= totalPrice %> </span></li>
                                            </ul>
                                        </div>
                                        <div class="your-order-info order-total">
                                            <ul>
                                                <li>Discount <span id="discount-amount" >₹<%= discount %> </span></li>
                                            </ul>
                                        </div>
                                        <div class="your-order-info order-total">
                                            <ul>
                                                <li>Total <span id="total-price">₹<%= totalPrice - discount %> </span></li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="payment-method">
                                        <h5>Payment Method</h5> 
                                        <input type="radio" name="paymentMethod" value="COD" style="width: 16px; height: 16px;" checked> COD
                                        <input type="radio" name="paymentMethod" value="Razorpay" style="width: 16px; height: 16px;"> Razorpay
                                    </div>
                                    
                                    
                                    <!-- <div class="condition-wrap">
                                        <p>Your personal data will be used to process your order, support your experience throughout this website, and for other purposes described in our <a href="#">privacy policy</a></p>
                                        <div class="condition-form mb-25">
                                            <input type="checkbox">
                                            <span>I have read and agree to the website <a href="#">terms and conditions</a><span class="star">*</span></span>
                                        </div>
                                    </div> -->
                                </div>
                               
                                
                                <div class="Place-order mt-30">
                                    <a href="#" id="placeOrderLink">Place Order</a>
                                </div>
                                
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Add Address Modal -->
<div class="modal fade" id="addAddressModal" tabindex="-1" aria-labelledby="addAddressModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addAddressModalLabel">Add New Address</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="addAddressForm">
                    <input type="hidden" id="address-id" value="">
                    
                    <div class="single-input-item">
                        <label for="addressName" class="required">Name</label>
                        <input type="text" name="name" class="form-control" id="addressName" placeholder="Enter name" required>
                    </div>
                    
                    <div class="single-input-item">
                        <label for="addressDetails" class="required">Address</label>
                        <input type="text" name="address" class="form-control" id="addressDetails" placeholder="Enter address" required>
                    </div>
                    
                    <div class="single-input-item">
                        <label for="city" class="required">City</label>
                        <input type="text" name="city" class="form-control" id="city" placeholder="Enter city" required>
                    </div>
                    
                    <div class="single-input-item">
                        <label for="state" class="required">State</label>
                        <input type="text" name="state" class="form-control" id="state" placeholder="Enter state" required>
                    </div>
                    
                    <div class="single-input-item">
                        <label for="zip" class="required">Zip Code</label>
                        <input type="text" name="pincode" class="form-control" id="zip" placeholder="Enter zip code" required>
                    </div>
                    
                    <div class="single-input-item">
                        <label for="country" class="required">Country</label>
                        <input type="text" name="country" class="form-control" id="country" placeholder="Enter country" required>
                    </div>
                    
                    <div class="single-input-item">
                        <label for="phone" class="required">Mobile No</label>
                        <input type="text" name="phone" class="form-control" id="phone" placeholder="Enter phone number" required>
                    </div>
                    
                    <div class="single-input-item">
                        <button type="submit" class="check-btn sqr-btn">Save Address</button>
                    </div>
                </form>
            </div>
            
        </div>
    </div>
</div>

        <!-- checkout end -->
        <footer class="footer-area section-padding-1 border-top-3">
            <div class="container-fluid">
                <div class="footer-top pt-100 pb-60">
                    <div class="row">
                        <div class="footer-column footer-width-24">
                            <div class="footer-widget footer-about mb-30">
                                <a href="index.html">
                                    <img src="assets/images/logo/logo.png" alt="logo">
                                </a>
                                <p>Lorem ipsum dolor sit amet, magna habemus ius ad, qui minimum voluptar</p>
                                <div class="social-icon-style-2 social-icon-hm4">
                                    <a class="facebook" href="#"><i class="fa fa-facebook"></i></a>
                                    <a class="twitter" href="#"><i class="fa fa-twitter"></i></a>
                                    <a class="youtube" href="#"><i class="fa fa-youtube"></i></a>
                                    <a class="dribbble" href="#"><i class="fa fa-dribbble"></i></a>
                                </div>
                            </div>
                        </div>
                        <div class="footer-column footer-width-12">
                            <div class="footer-widget footer-info-list-2 mb-30">
                                <h3 class="footer-title">Company Link</h3>
                                <ul>
                                    <li><a href="#">About Us</a></li>
                                    <li><a href="#">Help Center</a></li>
                                    <li><a href="#">Our Team</a></li>
                                    <li><a href="#">Privacy Policy</a></li>
                                    <li><a href="#">The Blog</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="footer-column footer-width-14">
                            <div class="footer-widget footer-info-list-2 mb-30">
                                <h3 class="footer-title">Userful Link</h3>
                                <ul>
                                    <li><a href="#">Guides & Articles</a></li>
                                    <li><a href="#">Customer Reviews</a></li>
                                    <li><a href="#">Coupon Codes</a></li>
                                    <li><a href="#">Military Discount</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="footer-column footer-width-19">
                            <div class="footer-widget footer-info-list-2 footer-contect mb-30">
                                <h3 class="footer-title">Contact info</h3>
                                <ul>
                                    <li><i class="dlicon ui-2_time-clock"></i> Monday - Friday: 9:00 - 19:00</li>
                                    <li><i class="dlicon ui-1_email-83"></i> info@example.com</li>
                                    <li><i class="dlicon tech-2_rotate"></i> (+612) 2531 5600</li>
                                    <li><i class="dlicon ui-1_home-simple"></i> PO Box 1622 Colins Street West Victoria 8077 Australia</li>
                                </ul>
                            </div>
                        </div>
                        <div class="footer-column footer-width-29 mb-30">
                            <div class="contact-page-map">
                                <div id="contact-map">
                                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3151.838709675939!2d144.95320007668528!3d-37.817246734238516!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x6ad65d4dd5a05d97%3A0x3e64f855a564844d!2s121%20King%20St%2C%20Melbourne%20VIC%203000%2C%20Australia!5e0!3m2!1sen!2sus!4v1670477011653!5m2!1sen!2sus" style="border:0;width:100%;height:100%;" allowfullscreen="" loading="lazy"></iframe>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="footer-botoom">
                    <div class="row">
                        <div class="col-12">
                            <div class="copyright-2 text-center">
                                <p>© 2021 <a href="https://hasthemes.com/">Toro.</a> All rights reserved.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
        <div class="support-lists">
            <ul>
                <li><a href="#"><i class="dlicon ui-3_chat-46"></i></a></li>
                <li><a href="#"><i class=" dlicon ui-3_phone"></i></a></li>
                <li><a href="#"><i class="dlicon ui-1_email-85"></i></a></li>
            </ul>
        </div>
    </div>

    <!-- All JS is here
============================================ -->

    <!-- Modernizer JS -->
    <script src="assets/js/vendor/modernizr-3.11.7.min.js"></script>
    <!-- jquery -->
    <script src="assets/js/vendor/jquery-v3.6.0.min.js"></script>
    <!-- Popper JS -->
    <script src="assets/js/vendor/popper.js"></script>
    <!-- Bootstrap JS -->
    <script src="assets/js/vendor/bootstrap.min.js"></script>
    <script src="assets/js/plugins/owl-carousel.js"></script>
    <script src="assets/js/plugins/slick.js"></script>
    <script src="assets/js/plugins/jarallax.min.js"></script>
    <script src="assets/js/plugins/countdown.js"></script>
    <script src="assets/js/plugins/magnific-popup.js"></script>
    <script src="assets/js/plugins/instafeed.js"></script>
    <script src="assets/js/plugins/tilt.js"></script>
    <script src="assets/js/plugins/images-loaded.js"></script>
    <script src="assets/js/plugins/isotope.js"></script>
    <script src="assets/js/plugins/scrolloverflow-fullpage.js"></script>
    <script src="assets/js/plugins/fullpage.js"></script>
    <script src="assets/js/plugins/jquery-ui.js"></script>
    <script src="assets/js/plugins/jquery-ui-touch-punch.js"></script>
    <script src="assets/js/plugins/easyzoom.js"></script>
    <script src="assets/js/plugins/resizesensor.js"></script>
    <script src="assets/js/plugins/sticky-sidebar.js"></script>
    <script src="assets/js/plugins/scrollup.js"></script>
    <script src="assets/js/plugins/select2.min.js"></script>
    <script src="assets/js/plugins/cookie.js"></script>
    <script src="assets/js/plugins/bpopup.js"></script>
    <script src="assets/js/plugins/wow.js"></script>
    <script src="assets/js/plugins/ajax-mail.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>

    <!-- Main JS -->
    <script src="assets/js/main.js"></script>
    <script>
       
       const addressData = JSON.parse(document.getElementById("addressContainer").dataset.address);

    
        function openEditAddressModal(addressId) {
            const address = addressData.find(row => row.addressDetails.some(details => details._id === addressId));
            const addressDetails = address ? address.addressDetails.find(details => details._id === addressId) : null;
    
            if (addressDetails) {
                document.getElementById("address-id").value = addressDetails._id;
                document.getElementById("addressName").value = addressDetails.name;
                document.getElementById("addressDetails").value = addressDetails.address;
                document.getElementById("city").value = addressDetails.city;
                document.getElementById("state").value = addressDetails.state;
                document.getElementById("zip").value = addressDetails.pincode;
                document.getElementById("country").value = addressDetails.country;
                document.getElementById("phone").value = addressDetails.phone;
                new bootstrap.Modal(document.getElementById("addAddressModal")).show();
            } else {
                console.error("Address not found.");
            }
        }
    
        document.getElementById("addAddressForm").addEventListener("submit", async function (event) {
            event.preventDefault();
    
            const addressId = document.getElementById("address-id").value;
            const url = addressId ? `/user/editaddress/${addressId}` : "/user/addaddress";
            const method = addressId ? 'PUT' : 'POST';
    
            const addressData = {
                name: document.getElementById("addressName").value.trim(),
                address: document.getElementById("addressDetails").value.trim(),
                city: document.getElementById("city").value.trim(),
                state: document.getElementById("state").value.trim(),
                pincode: document.getElementById("zip").value.trim(),
                country: document.getElementById("country").value.trim(),
                phone: document.getElementById("phone").value.trim()
            };
    
            try {
                const response = await fetch(url, {
                    method: method,
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(addressData)
                });
    
                const result = await response.json();
                if (result.success) {
                    Swal.fire("Success!", result.message, "success").then(() => {
                        window.location.reload();
                    });
                } else {
                    Swal.fire("Error!", result.message, "error");
                }
            } catch (error) {
                Swal.fire("Error!", "An error occurred. Please try again.", "error");
            }
        });
    
  
        document.getElementById("placeOrderLink").addEventListener("click", async function (event) {
    event.preventDefault();

    
    const selectedAddressId = document.querySelector("input[name='addressID']:checked")?.value;
    const paymentMethod = document.querySelector("input[name='paymentMethod']:checked").value;
    const additionalNotes = document.querySelector("textarea[name='message']").value || '';

    if (!selectedAddressId) {
        Swal.fire('Please select an address.');
        return;
    }

    const couponMessage = document.getElementById('coupon-message')
    if(couponMessage =="Coupon applied"){
        
        
    }
    const couponCode = document.getElementById('coupon-code').value;
    const orderData = {
        addressId: selectedAddressId,
        paymentMethod: paymentMethod,
        notes: additionalNotes,
        couponCode
    };

    if (paymentMethod === "Razorpay") {
        try {
            const response = await fetch("/user/checkout", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(orderData)
            });

            const order = await response.json();
            if (!order.success) {
                Swal.fire("Error", "Unable to initiate payment. Please try again.", "error");
                return;
            }

            const options = {
                key: "rzp_test_huxdedC8WMgMZj",
                amount: order.amount,
                currency: "INR",
                name: "Your Ecommerce",
                description: "Purchase Order",
                order_id: order.razorpayOrderId,
                handler: async function (response) {
                    const verifyPayment = await fetch("/user/checkout/verifyPayment", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({
                            paymentId: response.razorpay_payment_id,
                            orderId: response.razorpay_order_id,
                            signature: response.razorpay_signature,
                            addressId: selectedAddressId,
                            notes: additionalNotes,
                            couponCode
                        })
                    });

                    const result = await verifyPayment.json();

                    if (result.success) {
                        window.location.href = `/user/ordersuccess/${result.orderId}`;
                    } else {
                        Swal.fire("Payment verification failed. Please try again.");
                    }
                },
                prefill: {
                    name: "Customer Name",
                    email: "customer@example.com",
                    contact: "9000090000",
                },
                theme: { color: "#3399cc" }
            };

            const razorpay = new Razorpay(options);
            razorpay.open();
        } catch (error) {
            Swal.fire("Error!", "Unable to initiate Razorpay. Please try again.", "error");
        }
    } else {
        try {
            const response = await fetch("/user/checkout", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(orderData)
            });
            const result = await response.json();

            if (result.success) {
                Swal.fire({
                    icon: 'success',
                    title: 'Order Placed!',
                    text: 'Your order has been placed successfully!',
                    timer: 3000,
                    showConfirmButton: false
                });
                setTimeout(() => {
                    window.location.href = `/user/ordersuccess/${result.orderId}`;
                }, 3000);
            } else {
                Swal.fire({
                    icon: 'error',
                    title: 'Order Failed',
                    text: 'Failed to place order. Please try again.',
                    timer: 3000,
                    showConfirmButton: false
                });
            }
        } catch (error) {
            console.error("Error placing order:", error);
            Swal.fire({
                icon: 'error',
                title: 'Error',
                text: 'An error occurred while placing your order. Please try again later.',
                timer: 3000,
                showConfirmButton: false
            });
        }
    }
});

        let discountedTotalPrice = null;
        let discountAmount=null;

        async function applyCoupon(event) {
    event.preventDefault();
    const couponCode = document.getElementById('coupon-code').value;

    const response = await fetch('/user/checkout/applycoupon', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ couponCode }),
    });

    const result = await response.json();
    const messageElement = document.getElementById('coupon-message');

    if (result.success) {
        messageElement.textContent = `Coupon applied successfully: ${result.discount} off`;
        document.getElementById('remove-coupon').style.display = 'inline-block'; 
        document.getElementById('discount-amount').textContent = `₹${result.discount}`;
    document.getElementById('total-price').textContent = `₹${result.newTotal}`;
    } else {
        messageElement.textContent = result.message;
        messageElement.classList.add('error');
    }
}

function removeCoupon() {
    document.getElementById('coupon-code').value = ''; 
    document.getElementById('coupon-message').textContent = 'Coupon removed.';
    document.getElementById('remove-coupon').style.display = 'none'; 
}

// function removeCoupon() {
//     discountedTotalPrice = null; 
//     document.getElementById('discount-amount').textContent = '₹0';
//     document.getElementById('total-price').textContent = '₹<%= totalPrice %>'; e
//     document.getElementById('coupon-code').value = ''; 
//     document.getElementById('coupon-message').textContent = 'Coupon removed.';
//     document.getElementById('remove-coupon').style.display = 'none'; 
// }



async function fetchAvailableCoupons() {
    try {
        const response = await fetch('/user/checkout/listcoupon');
        const result = await response.json();

        if (result.success && result.coupons.length > 0) {
            const couponList = document.getElementById('coupon-list');
            couponList.innerHTML = '';
            result.coupons.forEach(coupon => {
                console.log(coupon);
                
                const listItem = document.createElement('li');
                listItem.textContent = `${coupon.couponCode} - ${coupon.discount}% off`;
                couponList.appendChild(listItem);
            });
        }
    } catch (error) {
        console.error("Error fetching available coupons:", error);
    }
}

document.addEventListener("DOMContentLoaded", fetchAvailableCoupons);



    </script>
    
    
    
    
    
    
    

</body>


<!-- Mirrored from template.hasthemes.com/toro/toro/checkout.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 09 Feb 2024 11:20:00 GMT -->
</html>